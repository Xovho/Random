-- amber bicycle canyon dove ember forest galaxy harbor icicle jupiter kayak lantern meadow nectar oasis prism quarry ripple summit tapestry umbrella vessel willow xylophone yonder zephyr atlas brook crest delta echo flint grove horizon isle jade kinetic lagoon meadow nebula orbit pebble quest ripple safari tundra umbra vortex whisper xenon yarrow zenith apron beacon cipher drifter echo fauna glimmer helm ivory jigsaw kinase lattice mosaic nexus ogre palette quantum relic sanctuary timber utopia valley wisp xenial yardarm zeppelin arcane briar citadel dahlia ember frost glade haven inkling juniper kaleidoscope lily mist nocturne opal psalm quay rune shimmer thyme umber verdant warp xenith yew zodiac arcadia baffler capsule dirge entangle flux gossamer hiatus infuse jolt keystone lullaby marquee nuance offset panorama quell ripple salient drift　

--// Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualUser = game:GetService("VirtualUser")
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Backpack = Player:WaitForChild("Backpack")
local GameEvents = ReplicatedStorage:WaitForChild("GameEvents")

--// Item Modules
local ItemModule = require(ReplicatedStorage:WaitForChild("Item_Module"))
local MutationHandler = require(ReplicatedStorage:WaitForChild("Modules"):WaitForChild("MutationHandler"))

--// GUI Setup
local ScreenGui = Instance.new("ScreenGui", Player:WaitForChild("PlayerGui"))
ScreenGui.Name = "GrowPlusGUI"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false

--// Main Frame
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 200, 0, 170)
MainFrame.Position = UDim2.new(0.5, -100, 0.5, -85)
MainFrame.BackgroundColor3 = Color3.fromRGB(101, 67, 33)
MainFrame.Visible = false
MainFrame.BorderSizePixel = 0

-- Banner
local Banner = Instance.new("Frame", MainFrame)
Banner.Size = UDim2.new(1, 0, 0, 20)
Banner.Position = UDim2.new(0, 0, 0, 0)
Banner.BackgroundColor3 = Color3.fromRGB(0, 128, 0)

local Title = Instance.new("TextLabel", Banner)
Title.Size = UDim2.new(1, 0, 1, 0)
Title.BackgroundTransparency = 1
Title.Text = "GROW PLUS"
Title.Font = Enum.Font.GothamBlack
Title.TextColor3 = Color3.new(1, 1, 1)
Title.TextStrokeColor3 = Color3.new(0, 0, 0)
Title.TextStrokeTransparency = 0
Title.TextScaled = true

-- Inventory Value Text
local ValueLabel = Instance.new("TextLabel", MainFrame)
ValueLabel.Size = UDim2.new(1, -10, 0, 18)
ValueLabel.Position = UDim2.new(0, 5, 1, -20)
ValueLabel.TextColor3 = Color3.new(1, 1, 1)
ValueLabel.BackgroundTransparency = 1
ValueLabel.TextXAlignment = Enum.TextXAlignment.Left
ValueLabel.Font = Enum.Font.GothamBold
ValueLabel.TextSize = 14
ValueLabel.Text = "₵ Calculating..."

-- Utility
local function shorten(num)
	if num >= 1e12 then return string.format("%.2fT", num / 1e12)
	elseif num >= 1e9 then return string.format("%.2fB", num / 1e9)
	elseif num >= 1e6 then return string.format("%.2fM", num / 1e6)
	elseif num >= 1e3 then return string.format("%.1fK", num / 1e3)
	else return tostring(num) end
end

local function calculateInventory()
	local total = 0
	for _, container in {Backpack, workspace:FindFirstChild(Player.Name)} do
		if container then
			for _, tool in ipairs(container:GetChildren()) do
				if tool:IsA("Tool")
					and tool:FindFirstChild("Weight")
					and tool:FindFirstChild("Item_String")
					and tool:FindFirstChild("Variant") then

					local data = ItemModule.Return_Data(tool.Item_String.Value)
					if data then
						local base = data[3]
						local div = data[2]
						local mult = ItemModule.Return_Multiplier(tool.Variant.Value)
						local mut = MutationHandler:CalcValueMulti(tool)
						local weight = tool.Weight.Value / div
						local rawPrice = base * mut * mult * math.clamp(weight, 0.95, 1e8)^2
						local price = math.round(rawPrice)
						total += price
						tool.Name = tool.Item_String.Value .. " [" .. shorten(price) .. "]"
					end
				end
			end
		end
	end
	return total
end

-- Inventory Value Loop
task.spawn(function()
	while true do
		local total = calculateInventory()
		ValueLabel.Text = "₵ " .. shorten(total)
		wait(1)
	end
end)

-- Toggle Button Creator
local function createToggle(name, posY)
	local frame = Instance.new("Frame", MainFrame)
	frame.Size = UDim2.new(0, 180, 0, 20)
	frame.Position = UDim2.new(0, 10, 0, posY)
	frame.BackgroundTransparency = 1

	local label = Instance.new("TextLabel", frame)
	label.Size = UDim2.new(0.6, 0, 1, 0)
	label.Text = name
	label.TextColor3 = Color3.new(1, 1, 1)
	label.BackgroundTransparency = 1
	label.Font = Enum.Font.Gotham
	label.TextSize = 14

	local toggleBG = Instance.new("Frame", frame)
	toggleBG.Size = UDim2.new(0, 40, 0, 18)
	toggleBG.Position = UDim2.new(1, -50, 0, 1)
	toggleBG.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
	toggleBG.BorderColor3 = Color3.new(0, 0, 0)
	Instance.new("UICorner", toggleBG).CornerRadius = UDim.new(1, 0)

	local circle = Instance.new("Frame", toggleBG)
	circle.Size = UDim2.new(0, 16, 0, 16)
	circle.Position = UDim2.new(0, 1, 0, 1)
	circle.BackgroundColor3 = Color3.new(1, 1, 1)
	circle.BorderSizePixel = 0
	Instance.new("UICorner", circle).CornerRadius = UDim.new(1, 0)

	local button = Instance.new("TextButton", toggleBG)
	button.Size = UDim2.new(1, 0, 1, 0)
	button.BackgroundTransparency = 1
	button.Text = ""

	return toggleBG, circle, button
end

-- Create Toggles
local harvestBG, harvestCircle, harvestBtn = createToggle("Auto Harvest", 25)
local eggBG, eggCircle, eggBtn = createToggle("Auto Buy Egg", 50)
local sprinklerBG, sprinklerCircle, sprinklerBtn = createToggle("Auto Buy Sprinkler", 75)
local antikickBG, antikickCircle, antikickBtn = createToggle("Anti Kick", 100)

-- Toggle Animation
local function updateToggle(state, bg, circle)
	bg.BackgroundColor3 = state and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(150, 150, 150)
	circle:TweenPosition(state and UDim2.new(0, 21, 0, 1) or UDim2.new(0, 1, 0, 1), "Out", "Quad", 0.2, true)
end

-- Identify Player's Farm
local MyFarm
for _, farm in ipairs(workspace:WaitForChild("Farm"):GetChildren()) do
	local owner = farm:FindFirstChild("Important") and farm.Important.Data:FindFirstChild("Owner")
	if owner and owner.Value == Player.Name then
		MyFarm = farm
	end
end
local PlantsPhysical = MyFarm and MyFarm.Important:WaitForChild("Plants_Physical")

-- Auto Harvest
local autoHarvest = false
harvestBtn.MouseButton1Click:Connect(function()
	autoHarvest = not autoHarvest
	updateToggle(autoHarvest, harvestBG, harvestCircle)
	if autoHarvest then
		task.spawn(function()
			while autoHarvest do
				for _, plant in ipairs(PlantsPhysical:GetChildren()) do
					if not autoHarvest then break end
					local prompt = plant:FindFirstChildWhichIsA("ProximityPrompt", true)
					if prompt and prompt.Enabled then
						Character:PivotTo(plant:GetPivot() + Vector3.new(0, 5, 0))
						task.wait(0.05)
						fireproximityprompt(prompt)
						task.wait(0.05)
					end
				end
				task.wait(0.3)
			end
		end)
	end
end)

-- Auto Buy Egg
local autoEgg = false
eggBtn.MouseButton1Click:Connect(function()
	autoEgg = not autoEgg
	updateToggle(autoEgg, eggBG, eggCircle)
	if autoEgg then
		task.spawn(function()
			while autoEgg do
				for i = 1, 3 do
					GameEvents.BuyPetEgg:FireServer(i)
				end
				task.wait(3)
			end
		end)
	end
end)

-- Auto Buy Sprinkler
local autoSprinkler = false
sprinklerBtn.MouseButton1Click:Connect(function()
	autoSprinkler = not autoSprinkler
	updateToggle(autoSprinkler, sprinklerBG, sprinklerCircle)
	if autoSprinkler then
		local list = {
			"Basic Sprinkler",
			"Advanced Sprinkler",
			"Godly Sprinkler",
			"Master Sprinkler"
		}
		task.spawn(function()
			while autoSprinkler do
				for _, name in ipairs(list) do
					GameEvents.BuyGearStock:FireServer(name)
				end
				task.wait(20)
			end
		end)
	end
end)

-- Anti Kick
local antiKick = false
antikickBtn.MouseButton1Click:Connect(function()
	antiKick = not antiKick
	updateToggle(antiKick, antikickBG, antikickCircle)
	if antiKick then
		Player.Idled:Connect(function()
			VirtualUser:Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
			task.wait(1)
			VirtualUser:Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
		end)
	end
end)

-- GUI Toggle Button
local toggleBtn = Instance.new("TextButton", ScreenGui)
toggleBtn.Size = UDim2.new(0, 30, 0, 30)
toggleBtn.Position = UDim2.new(0.5, -15, 0, 5)
toggleBtn.BackgroundColor3 = Color3.fromRGB(101, 67, 33)
toggleBtn.BorderColor3 = Color3.new(0, 0, 0)
toggleBtn.BorderSizePixel = 2
toggleBtn.Text = "+"
toggleBtn.TextScaled = true
toggleBtn.TextColor3 = Color3.new(1, 1, 1)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.MouseButton1Click:Connect(function()
	MainFrame.Visible = not MainFrame.Visible
	toggleBtn.Text = MainFrame.Visible and "−" or "+"
end)
